// Test for borrow checking: borrowing rules
// This test should COMPILE successfully

type Counter {
    value int
}

func read_counter(c Counter) int {
    // Shared borrow: c is const Counter*
    return c.value
}

func increment_counter(c var Counter) {
    // Mutable borrow: c is Counter*
    c.value = c.value + 1
}

func take_counter(c mov Counter) Counter {
    // Ownership transfer: c is Counter (value), return it to consume
    return mov c
}

func main() int {
    var cnt Counter
    cnt.value = 10
    
    // Test 1: Multiple shared borrows OK
    x = read_counter(cnt)
    y = read_counter(cnt)  // OK: multiple shared borrows
    
    // Test 2: Mutable borrow
    increment_counter(var cnt)
    
    // Test 3: Shared borrow after mutable borrow ends
    z = read_counter(cnt)  // OK: mutable borrow ended
    
    // Test 4: Move consumes ownership
    final_counter = take_counter(mov cnt)
    
    // Note: using cnt after move would be caught by linearity checker
    return final_counter.value
}
